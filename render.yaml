services:
  - type: web
    name: food-delivery-user-service
    env: docker
    plan: free # Explicitly select the free instance type
    dockerContext: .
    dockerfilePath: ./user_service/Dockerfile
    envVars:
      - key: DATABASE_URL
        fromDatabase:
          name: food-delivery-shared-db # Use the shared database
          property: connectionString
      - key: USER_SERVICE_URL
        value: https://food-delivery-user-service.onrender.com
      - key: RESTAURANT_SERVICE_URL
        value: https://food-delivery-restaurant-service.onrender.com
      - key: DELIVERY_AGENT_SERVICE_URL
        value: https://food-delivery-delivery-service.onrender.com

  - type: web
    name: food-delivery-restaurant-service
    env: docker
    plan: free # Explicitly select the free instance type
    dockerContext: .
    dockerfilePath: ./restaurant_service/Dockerfile
    envVars:
      - key: DATABASE_URL
        fromDatabase:
          name: food-delivery-shared-db # Use the shared database
          property: connectionString
      - key: USER_SERVICE_URL
        value: https://food-delivery-user-service.onrender.com
      - key: RESTAURANT_SERVICE_URL
        value: https://food-delivery-restaurant-service.onrender.com
      - key: DELIVERY_AGENT_SERVICE_URL
        value: https://food-delivery-delivery-service.onrender.com

  - type: web
    name: food-delivery-delivery-service
    env: docker
    plan: free # Explicitly select the free instance type
    dockerContext: .
    dockerfilePath: ./delivery_service/Dockerfile
    envVars:
      - key: DATABASE_URL
        fromDatabase:
          name: food-delivery-shared-db # Use the shared database
          property: connectionString
      - key: USER_SERVICE_URL
        value: https://food-delivery-user-service.onrender.com
      - key: RESTAURANT_SERVICE_URL
        value: https://food-delivery-restaurant-service.onrender.com
      - key: DELIVERY_AGENT_SERVICE_URL
        value: https://food-delivery-delivery-service.onrender.com

databases:
  - name: food-delivery-shared-db # Define only one shared database
    plan: free